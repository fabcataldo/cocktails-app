
<div class="card">
    <p-table
        #cocktailsTable
        [value]="pageFacade.loaded() ? pageFacade.cocktailsByLetterOrName()! : skeletonRows"
        [tableStyle]="{ 'min-width': '60rem' }"
        [loading]="pageFacade.loading()"
        [lazy]="true"
        [filters]="pageFacade.filters()"
        [rowHover]="true"
        (onLazyLoad)="pageFacade.searchByFilters($event)"
    >
        <ng-template #header>
            <tr>
                <th style="width:22%">
                    <div class="flex items-center justify-between">
                        ID
                    </div>
                </th>
                <th style="width:22%">
                    <div class="flex items-center justify-between">
                        Image
                    </div>
                </th>
                <th style="width:22%">
                    <div class="flex items-center justify-between">
                        Name
                        <p-columnFilter type="text" field="name" placeholder="Type to search" ariaLabel="Filter Name" filterOn="input"></p-columnFilter>
                    </div>
                </th>
                <th style="width:22%">
                    <div class="flex items-center justify-between">
                        Category
                        <p-columnFilter
                            field="category"
                            matchMode="in"
                            display="menu"
                            [showMatchModes]="false"
                            [showOperator]="false"
                            [showAddButton]="false"
                        >
                            <ng-template #filter let-value let-filter="filterCallback">
                                <p-multiselect
                                    (model)="value"
                                    [options]="pageFacade.categoriesFilterItems() || []"
                                    placeholder="Any"
                                    (onChange)="filter($event.value)"
                                    optionLabel="name"
                                    optionValue="id"
                                    [showHeader]="false"
                                    class="w-full"
                                    >
                                    <ng-template let-option #item>
                                        <div class="flex items-center gap-2">
                                            <span>{{ option.name }}</span>
                                        </div>
                                    </ng-template>
                                </p-multiselect>
                            </ng-template>
                        </p-columnFilter>
                    </div>
                </th>
                <th style="width:22%">
                    <div class="flex items-center justify-between">
                        Alcoholic
                        <p-columnFilter type="boolean" field="alcoholic" display="menu" />
                    </div>
                </th>
                <th style="width:22%">
                    <div class="flex items-center justify-between">
                        Ingredients
                        <p-columnFilter
                            field="ingredients"
                            matchMode="in"
                            display="menu"
                            [showMatchModes]="false"
                            [showOperator]="false"
                            [showAddButton]="false"
                        >
                            <ng-template #filter let-value let-filter="filterCallback">
                                <p-multiselect
                                    (model)="value"
                                    [options]="pageFacade.ingredientsFilterItems() || []"
                                    placeholder="Any"
                                    (onChange)="filter($event.value)"
                                    optionLabel="name"
                                    optionValue="id"
                                    [showHeader]="false"
                                    style="min-width: 14rem"
                                    [panelStyle]="{ minWidth: '16rem' }"
                                    >
                                    <ng-template let-option #item>
                                        <div class="flex items-center gap-2">
                                            <span>{{ option.name }}</span>
                                        </div>
                                    </ng-template>
                                </p-multiselect>
                            </ng-template>
                        </p-columnFilter>
                    </div>
                </th>
                <th style="width:22%">
                    <div class="flex items-center justify-between">
                        Last Update
                    </div>
                </th>
            </tr>
        </ng-template>

        <ng-template #body let-cocktail>
            <tr>
                <td>{{ cocktail.id }}</td>
                <td>
                    <div class="flex items-center gap-2">
                        <img
                            [src]="cocktail.thumbnail"
                            [alt]="cocktail.name"
                            class="w-4rem h-4rem border-round object-fit-cover"
                        />
                    </div>

                </td>
                <td>
                    <span class="font-medium text-900">{{ cocktail.name }}</span>
                </td>
                <td>
                    <p-tag 
                        [value]="cocktail.category" 
                        severity="info"
                        styleClass="text-sm">
                    </p-tag>
                </td>
                <td class="text-center">
                    <p-tag 
                        [value]="cocktail.alcoholic === true ? 'Yes' : 'No'"
                        [severity]="cocktail.alcoholic === true ? 'success' : 'warning'"
                        class="text-sm">
                    </p-tag>
                </td>
                <td>
                    <span class="text-sm text-700">{{ cocktail.ingredients.join(', ') }}</span>
                </td>
                <td>
                    <span class="text-sm text-600">{{ cocktail.dateModified }}</span>
                </td>
            </tr>
        </ng-template>
        <ng-template #emptymessage>
            <tr>
                <td colspan="7" class="text-center p-4">
                    <div class="flex flex-column align-items-center">
                        <span class="text-xl text-500 mb-2">No cocktails found</span>
                        <span class="text-sm text-400">Try adjusting your filters</span>
                    </div>
                </td>
            </tr>
        </ng-template>
        <ng-template #footer>
            <tr>
                <td colspan="7" class="text-center p-3">
                    <div class="flex justify-content-center align-items-center gap-2">
                        <p-tag value="{{ pageFacade.alcoholicNoAlcoholicCocktails().alcoholic.length }}" severity="success"></p-tag>
                        <span class="text-sm">alcoholic and</span>
                        <p-tag value="{{ pageFacade.alcoholicNoAlcoholicCocktails().nonAlcoholic.length }}" severity="warning"></p-tag>
                        <span class="text-sm">non-alcoholic cocktails</span>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
